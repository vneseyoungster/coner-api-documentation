<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coner Backend Documentation</title>
    <link rel="stylesheet" href="assets/styles.css">
</head>
<body data-environment="development">
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <h1>Coner Backend API</h1>
            <p class="version">Loading...</p>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-content">
            <!-- Navigation will be loaded dynamically -->
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <!-- Welcome Section -->
        <section class="section">
            <h2>Welcome to Coner Backend Documentation</h2>
            <p>Comprehensive documentation for the Coner Backend API, including API reference, version history, and technical guidelines.</p>
        </section>

        <!-- Feature Cards -->
        <div class="feature-grid">
            <div class="feature-card" onclick="location.href='api.html'">
                <div class="icon">üìö</div>
                <h4>API Reference</h4>
                <p>Complete API endpoint documentation with request/response examples, authentication guides, and code samples.</p>
                <ul>
                    <li>Authentication endpoints</li>
                    <li>User profile management</li>
                    <li>Error handling</li>
                    <li>Code examples (cURL, PowerShell)</li>
                </ul>
            </div>

            <div class="feature-card" onclick="location.href='changelog.html'">
                <div class="icon">üìã</div>
                <h4>Changelog</h4>
                <p>Track changes across all environments with detailed version history and release notes.</p>
                <ul>
                    <li>Production releases</li>
                    <li>Staging updates</li>
                    <li>Development features</li>
                    <li>Breaking changes & migrations</li>
                </ul>
            </div>

            <div class="feature-card" onclick="location.href='technical-docs.html'">
                <div class="icon">‚öôÔ∏è</div>
                <h4>Technical Documentation</h4>
                <p>API design rules, conventions, and best practices for developers.</p>
                <ul>
                    <li>Naming conventions (snake_case)</li>
                    <li>HTTP response codes</li>
                    <li>Versioning policy</li>
                    <li>Authentication flow</li>
                </ul>
            </div>
        </div>

        <!-- Quick Links Section -->
        <section class="section">
            <h2>Quick Links</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üöÄ Getting Started</h4>
                    <p>New to the Coner API? Start here:</p>
                    <ol style="margin-left: 1.5rem;">
                        <li><a href="api.html#auth-endpoints">Authentication Flow</a></li>
                        <li><a href="api.html#profile-endpoints">Profile Setup</a></li>
                        <li><a href="api.html#dev-endpoints">Code Examples</a></li>
                    </ol>
                </div>

                <div class="feature-card">
                    <h4>üìñ Popular Endpoints</h4>
                    <ul style="margin-left: 1.5rem;">
                        <li><code>POST /auth/signup</code></li>
                        <li><code>POST /auth/signin</code></li>
                        <li><code>GET /users/profile</code></li>
                        <li><code>PUT /users/profile-first</code></li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>üîß Developer Resources</h4>
                    <ul style="margin-left: 1.5rem;">
                        <li><a href="technical-docs.html#design-rules">API Design Rules</a></li>
                        <li><a href="api.html#errors">Error Handling</a></li>
                        <li><a href="changelog.html">Latest Changes</a></li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Environment Status -->
        <section class="section">
            <h2>Environment Status</h2>
            <table>
                <thead>
                    <tr>
                        <th>Environment</th>
                        <th>Base URL</th>
                        <th>Version</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="env-status">
                    <!-- Will be populated dynamically -->
                </tbody>
            </table>
        </section>

        <!-- Key Features -->
        <section class="section">
            <h2>Key Features</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                <div class="alert info">
                    <strong>üîê JWT Authentication</strong>
                    <p>Secure authentication using Supabase with automatic token refresh.</p>
                </div>
                <div class="alert success">
                    <strong>üìè Consistent API Design</strong>
                    <p>All endpoints follow strict naming conventions and response formats.</p>
                </div>
                <div class="alert warning">
                    <strong>üìä Version Control</strong>
                    <p>URL-based versioning with clear breaking change policies.</p>
                </div>
                <div class="alert info">
                    <strong>üõ°Ô∏è Type Safety</strong>
                    <p>Zod schema validation for all requests and responses.</p>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <div class="footer">
        <!-- Footer will be loaded dynamically -->
    </div>

    <!-- Scripts -->
    <script src="assets/scripts.js"></script>
    <script>
        // Initialize page
        initPage('index.html');

        // Load and display environment status
        async function loadEnvironmentStatus() {
            const sharedConfig = await ConfigLoader.loadShared();
            if (!sharedConfig) return;

            const tbody = document.getElementById('env-status');
            tbody.innerHTML = '';

            Object.entries(sharedConfig.environments).forEach(([key, env]) => {
                const row = document.createElement('tr');

                const statusClass = env.status === 'stable' ? 'success' :
                                   env.status === 'testing' ? 'warning' : 'info';

                row.innerHTML = `
                    <td><strong>${env.name}</strong></td>
                    <td><code>${env.baseUrl}</code></td>
                    <td><code>${env.version}</code></td>
                    <td><span class="badge ${statusClass}">${env.status}</span></td>
                `;

                tbody.appendChild(row);
            });
        }

        loadEnvironmentStatus();
    </script>
</body>
</html>
